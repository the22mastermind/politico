{"version":3,"sources":["../../src/controllers/offices.js"],"names":["exports","createOffice","req","res","validator","validateCreateOffice","body","error","status","json","details","message","office","officeModel","find","o","type","trim","name","newOffice","id","length","push","data","viewAllOffices","viewSpecificOffice","params","Number","isInteger","parseInt"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;;;AAEA;AACAA,QAAQC,YAAR,GAAuB,gBAAgBC,GAAhB,EAAqBC,GAArB,EAA0B;AAChD;AADgD,6BAE9BC,qBAAUC,oBAAV,CAA+BH,IAAII,IAAnC,CAF8B;AAAA,KAExCC,KAFwC,yBAExCA,KAFwC;;AAGhD,KAAIA,KAAJ,EAAW;AACV,SAAOJ,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC3BD,WAAQ,GADmB;AAE3BD,UAAOA,MAAMG,OAAN,CAAc,CAAd,EAAiBC;AAFG,GAArB,CAAP;AAIA;AACD;AACA,KAAMC,SAAS,MAAMC,kBAAYC,IAAZ,CAAiB;AAAA,SAAKC,EAAEC,IAAF,KAAWd,IAAII,IAAJ,CAASU,IAAT,CAAcC,IAAd,EAAX,IAAmCF,EAAEG,IAAF,KAAWhB,IAAII,IAAJ,CAASY,IAAT,CAAcD,IAAd,EAAnD;AAAA,EAAjB,CAArB;AACA,KAAIL,MAAJ,EAAY;AACX,SAAOT,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC3BD,WAAQ,GADmB;AAE3BD,oCAA+BL,IAAII,IAAJ,CAASU,IAAT,CAAcC,IAAd,EAA/B,qBAAmEf,IAAII,IAAJ,CAASY,IAAT,CAAcD,IAAd,EAAnE;AAF2B,GAArB,CAAP;AAIA;AACD;AACA,KAAME,YAAY;AACjBC,MAAIP,kBAAYQ,MAAZ,GAAqB,CADR;AAEjBL,QAAMd,IAAII,IAAJ,CAASU,IAAT,CAAcC,IAAd,EAFW;AAGjBC,QAAMhB,IAAII,IAAJ,CAASY,IAAT,CAAcD,IAAd;AAHW,EAAlB;AAKAJ,mBAAYS,IAAZ,CAAiBH,SAAjB;AACA,QAAOhB,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC3BD,UAAQ,GADmB;AAE3Be,QAAM,CACJ;AACCH,OAAID,UAAUC,EADf;AAECJ,SAAMG,UAAUH,IAFjB;AAGCE,SAAMC,UAAUD;AAHjB,GADI;AAFqB,EAArB,CAAP;AAUA,CAlCD;;AAoCA;AACAlB,QAAQwB,cAAR,GAAyB,gBAAgBtB,GAAhB,EAAqBC,GAArB,EAA0B;AAClD,QAAOA,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC3BD,UAAQ,GADmB;AAE3Be,QAAMV;AAFqB,EAArB,CAAP;AAIA,CALD;;AAOA;AACAb,QAAQyB,kBAAR,GAA6B,gBAAgBvB,GAAhB,EAAqBC,GAArB,EAA0B;AACtD;AADsD,KAE9CiB,EAF8C,GAEvClB,IAAIwB,MAFmC,CAE9CN,EAF8C;;AAGtD,KAAI,CAACO,OAAOC,SAAP,CAAiBC,SAAST,EAAT,EAAa,EAAb,CAAjB,CAAL,EAAyC;AACxC,SAAOjB,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC3BD,WAAQ,GADmB;AAE3BD,UAAUa,EAAV;AAF2B,GAArB,CAAP;AAIA,EALD,MAKO;AACN,MAAMR,SAAS,MAAMC,kBAAYC,IAAZ,CAAiB;AAAA,UAAKC,EAAEK,EAAF,KAASS,SAAST,EAAT,EAAa,EAAb,CAAd;AAAA,GAAjB,CAArB;AACA,MAAIR,MAAJ,EAAY;AACX,UAAOT,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC3BD,YAAQ,GADmB;AAE3Be,UAAMX;AAFqB,IAArB,CAAP;AAIA,GALD,MAKO;AACN,UAAOT,IAAIK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC3BD,YAAQ,GADmB;AAE3BD,8BAAwBa,EAAxB;AAF2B,IAArB,CAAP;AAIA;AACD;AACD,CAtBD","file":"offices.js","sourcesContent":["import officeModel from '../models/offices';\nimport validator from '../middlewares/validation';\nimport moment from 'moment';\n\n// create Party\nexports.createOffice = async function (req, res) {\n\t// Joi Validation\n\tconst { error } = validator.validateCreateOffice(req.body);\n\tif (error) {\n\t\treturn res.status(400).json({\n\t\t\tstatus: 400,\n\t\t\terror: error.details[0].message\n\t\t});\n\t}\n\t// Check if office (type and name) is already registered\n\tconst office = await officeModel.find(o => o.type === req.body.type.trim() && o.name === req.body.name.trim());\n\tif (office) {\n\t\treturn res.status(400).json({\n\t\t\tstatus: 400,\n\t\t\terror: `The office of type: <${req.body.type.trim()}> and name: <${req.body.name.trim()}> is already registered.`\n\t\t});\n\t}\n\t// Register office\n\tconst newOffice = {\n\t\tid: officeModel.length + 1,\n\t\ttype: req.body.type.trim(),\n\t\tname: req.body.name.trim()\n\t};\n\tofficeModel.push(newOffice);\n\treturn res.status(201).json({\n\t\tstatus: 201,\n\t\tdata: [\n\t\t  {\n\t\t  \tid: newOffice.id,\n\t\t  \ttype: newOffice.type,\n\t\t  \tname: newOffice.name\n\t\t  }\n\t\t]\n\t});\n};\n\n// view all offices\nexports.viewAllOffices = async function (req, res) {\n\treturn res.status(200).json({\n\t\tstatus: 200,\n\t\tdata: officeModel\n\t});\n};\n\n// view specific office\nexports.viewSpecificOffice = async function (req, res) {\n\t// Check if param is integer\n\tconst { id } = req.params;\n\tif (!Number.isInteger(parseInt(id, 10))) {\n\t\treturn res.status(400).json({\n\t\t\tstatus: 400,\n\t\t\terror: `${id} must be an integer`\n\t\t});\n\t} else {\n\t\tconst office = await officeModel.find(o => o.id === parseInt(id, 10));\n\t\tif (office) {\n\t\t\treturn res.status(200).json({\n\t\t\t\tstatus: 200,\n\t\t\t\tdata: office\n\t\t\t});\n\t\t} else {\n\t\t\treturn res.status(404).json({\n\t\t\t\tstatus: 404,\n\t\t\t\terror: `Office of id: ${id} not found`\n\t\t\t});\n\t\t}\n\t}\n};\n"]}